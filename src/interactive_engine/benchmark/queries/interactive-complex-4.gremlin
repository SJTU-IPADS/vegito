g.V().has('person','id',$personId).out('knows').fold().store('friends').unfold().in('hasCreator').hasLabel('post').has('creationDate',inside($startDate,$endDate)).out('hasTag').filter(__.in('hasTag').hasLabel('post').has('creationDate', lt($startDate)).out('hasCreator').where(within('friends')).count().is(0)).groupCount().unfold().order().by(select(values),decr).by(select(keys).values('name')).limit(10)